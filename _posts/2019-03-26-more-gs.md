---
layout: post
title: More Geometry Shader
---

I have done more experiments on the geometry shader since the last blog update. And I also defined the PotentialField class for simulating a scalar field. 

The scalar field is defined by the vertex position of the minimum corner and the maximum corner, together with the resolution parameter. The resolution parameter is simply describing how many voxels should be present in each side of the potential field. For example, if we set the grid resolution to 50, there will be 50 x 50 x 50 voxels forming the whole scalar field. 

The scalar field is then passed to our shaders with a vertex buffer defining every single center point of a voxel. As the input primitive here is a single point, it is better to visualize them clearer in some way. Geometry shader is the solution.

I then use the voxel's position as the input and output a triangle for each voxel. Here's the result:

![]({{ site.baseurl }}/images/more-gs-1.png)

It is simply done by appending and offseting the three vertices that constructs the output triangle.
```glsl
layout (point) in;
layout (triangle_strip, max_vertices = 3) out;

void main() {   
    gl_Position = gl_in[0].gl_Position + vec4(0.0f, 0.0f, 0.0f, 0.0f);
    EmitVertex();
    gl_Position = gl_in[0].gl_Position + vec4(0.1f, 0.1f, 0.0f, 0.0f);
    EmitVertex();
    gl_Position = gl_in[0].gl_Position + vec4(-0.1f, 0.1f, 0.0f, 0.0f);
    EmitVertex();
    EndPrimitive();
} 
```

![]({{ site.baseurl }}/images/more-gs-2.png)

And for fun, I colored them according to its world position and obtained the above result!